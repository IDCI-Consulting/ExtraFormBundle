export default "{\n    \"name\": \"winnie_lapin_participation\",\n    \"options\": {\n        \"display_step_in_url\": true\n    },\n    \"steps\": {\n        \"home\": {\n            \"type\": \"html\",\n            \"options\": {\n               \"title\": \"Unique comme <span class='lastWord'>TOI</span> !\",\n               \"content\":\"\",\n               \"attr\": {\n                   \"class\": \"home\"\n               },\n               \"events\": {\n                    \"form.pre_set_data\": [\n                        {\n                            \"action\": \"retrieve_request_data\",\n                            \"name\": \"route_name\",\n                            \"parameters\": {\n                                \"property\": \"attributes\",\n                                \"key\": \"_parent_route\"\n                            }\n                        },\n                        {\n                            \"action\": \"retrieve_availability_product\",\n                            \"name\": \"retrieved_availability_product\",\n                            \"parameters\": {\n                                \"stockspace\": \"winnielapin\",\n                                \"id\": \"{{ participation.offer.products.0.id }}\",\n                                \"quantity\": 1\n                            }\n                        },\n                        {\n                            \"action\": \"change_data\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.home.route_name in [\\'portal_page_offer_participate\\', \\'portal_page_home\\'] }}' }}\",\n                                \"fields\": {\n                                    \"content\":\"<div class='row headHomePage'><p class='offerDate'>Du {{ participation.offer.startsAt|date('d/m/y') }} au {{ participation.offer.endsAt|date('d/m/y') }}</p><div class='lapinCount show-for-medium-up'><div class='box'>{{ '{{ flow_data.retrievedData.home.retrieved_availability_product.quantity }}' }}</div></br><p>coques et étuis de portable disponibles *</p></div></div><ul class='slider columns small-12' data-orbit data-options='pause_on_hover:false;slide_number:false; timer_speed: 4000;'><li><img class='show-for-medium-up' src='https://media-manager.digifid.fr/api/media/2786408889-1494801640-7996d16ac11d24a9d7ec02ca0f2b5298-7625' alt='Recois  ta coque unique' \\/><img class='show-for-small-only' src='https://media-manager.digifid.fr/api/media/2786408889-1494788319-52c3b2a04b9e4568c778809c3d9d54d5-9067' alt='Recois ta coque unique' \\/><\\/li><li><img class='show-for-medium-up' src='https://media-manager.digifid.fr/api/media/2786408889-1494801917-1fdf8a91fd061d108b6e34c37f55a3f5-9814' alt='1 pot miel' \\/><img class='show-for-small-only' src='https://media-manager.digifid.fr/api/media/2786408889-1494788320-a34c11e69ca2339110916a5404dd5dfb-2843' alt='1 pot miel' \\/><\\/li><\\/ul><div class='lapinCountMobile show-for-small-only'><div class='box'></div><br><p>coques et étuis de portable disponibles *</p></div><br>\"\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"change_data\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.home.route_name == \\'portal_page_offer_participate_replay\\' }}' }}\",\n                                \"fields\": {\n                                    \"content\":\"<div class='row headHomePage'><p class='offerDate'>Du {{ participation.offer.startsAt|date('d/m/y') }} au {{ participation.offer.endsAt|date('d/m/y') }}</p><div class='lapinCount show-for-medium-up'><div class='box'>{{ '{{ flow_data.retrievedData.home.retrieved_availability_product.quantity }}' }}</div></br><p>coques et étuis de portable disponibles *</p></div></div><p>REPLAY</p><div class='lapinCountMobile show-for-small-only'><div class='box'></div><br><p>coques et étuis de portable disponibles *</p></div><br>\"\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"add_link\",\n                            \"parameters\": {\n                                \"link_options\": {\n                                    \"label\": \"Comment obtenir ma coque de portable miel ® ?\",\n                                    \"href\": \"/content/commandeCoque\",\n                                    \"attr\": {\n                                        \"class\": \"button previous-lapin button-black\"\n                                    }\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        \"code\": {\n            \"type\": \"form\",\n            \"options\": {\n                \"title\": \"Saisissez votre <span class='lastWord'>code</span>\",\n                \"js\": \"$('input').bind('input', function() {this.value = this.value.toLocaleUpperCase();});\",\n                \"display_title\": true,\n                \"attr\": {\n                    \"class\": \"code\"\n                },\n                \"prevent_previous\": true,\n                \"@builder\": {\n                    \"worker\": \"extra_form_builder\",\n                    \"parameters\": {\n                        \"configuration\": {\n                            \"notice\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<p class='offerDate'>Renseignez ci-dessous votre code unique &nbsp;</b> <a href='#'data-reveal-id='proofModal'><img src=\\\"/bundles/themes/winnie.lapin/tmswebportalbundle/images/help_icon.png\\\" alt=\\\"Page info\\\" title=\\\"page info\\\" width=\\\"17\\\" height=\\\"16\\\" /></a></p><div id='proofModal' class='reveal-modal small' data-reveal aria-labelledby='modalTitle' aria-hidden='true' role='dialog'><p class='titleModal'>Où se trouve le code unique ?</p><p>Ce code est composé de 12 caractères alphanumériques et est disponible au<br />dos de votre pot collector unique de miel <sup>&reg;</sup> 950g.</p><p><img style='width:60%; max-width: 266px;' src='https://media-manager.digifid.fr/api/media/2786408889-1494788483-6f45f279c2a2397bf93677cedf51cbcf-3918' alt='Code miel'/></p><a class='close-reveal-modal help button' aria-label='Close'>Fermer</a></div></p>\",\n                                    \"attr\": {\n                                        \"class\": \"noticeRed\"\n                                    }\n                                }\n                            },\n                            \"purchase-1_usableCodes\": {\n                                \"extra_form_type\": \"extra_form_collection\",\n                                \"options\": {\n                                    \"type\": \"extra_form_builder\",\n                                    \"min_items\": 1,\n                                    \"max_items\": 20,\n                                    \"label\": \" \",\n                                    \"add_button\": {\n                                        \"label\": \"+ Ajouter un code\",\n                                        \"attr\": {\n                                            \"class\": \"add_code buttonStroke\"\n                                        }\n                                    },\n                                    \"remove_button\": {\n                                        \"label\": \"X\",\n                                        \"attr\": {\n                                            \"class\": \"remove_code\"\n                                        }\n                                    },\n                                    \"options\": {\n                                        \"configuration\": {\n                                            \"code\": {\n                                                \"extra_form_type\": \"text\",\n                                                \"options\": {\n                                                    \"label\": \" \",\n                                                    \"max_length\": 12,\n                                                    \"required\": true,\n                                                    \"attr\": {\n                                                        \"class\": \"tms_code half_column_small\",\n                                                        \"placeholder\": \"Votre code ici\"\n                                                    }\n                                                },\n                                                \"constraints\": [\n                                                    {\n                                                        \"extra_form_constraint\": \"not_blank\",\n                                                        \"options\": {\n                                                            \"message\": \"Entrer un code unique\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"extra_form_constraint\": \"tms_eligibility_checker\",\n                                                        \"options\": {\n                                                            \"checkerPath\": \"usablecode\",\n                                                                \"parameters\": {\n                                                                \"codespace\": \"winnielapin\",\n                                                                \"offer\": \"{{ participation.offer.id }}\",\n                                                                \"limit\": \"1\"\n                                                            },\n                                                            \"parameterKey\": \"usable_code\",\n                                                            \"messages\": {\n                                                                \"500\": \"Nous sommes désolés mais nous ne pouvons vérifier actuellement la validité du code que vous avez saisi. Veuillez réessayer ultérieurement.\",\n                                                                \"404\": \"Le code que vous avez saisi est erroné.\",\n                                                                \"409\": \"Le code que vous avez saisi a déjà été utilisé.\"\n                                                            }\n                                                        }\n                                                    }\n                                                ]\n                                            }\n                                        }\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"tms_collection_unique_item\",\n                                        \"options\": {\n                                            \"message\": \"Vous ne pouvez pas saisir 2 fois le même code\",\n                                            \"subField\": \"code\",\n                                            \"stopOnceFoundFirst\": \"1\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"notabene\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<div style='text-align:center; font-size:0.9em; font-style:italic;'>Pour renseigner plusieurs pots collectors uniques de miel&reg; achetés sur le même ticket de caisse, cliquez sur <span style='font-weight:bold; color:#e32a2e;'>'Ajouter un code'.</span><br /><br />Si vous souhaitez renseigner des achats présents sur un autre ticket de caisse, vous devez refaire une participation.</div><br><br>\"\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        },\n        \"personalize\": {\n            \"type\": \"form\",\n            \"options\": {\n                \"title\": \"\",\n                \"js\": \"var countEditor = $('.offerDate').length;$('.offerDate').each(function(index) {var indice = index + 1;var nmbrPhone = ' '+indice + '/' + countEditor;$(this).append(nmbrPhone);});\",\n                \"display_title\": false,\n                \"previous_options\": {\"label\": \"Précédent\"},\n                \"attr\": {\n                    \"class\": \"personalize half_column split_line\"\n                },\n                \"@builder\": {\n                    \"worker\": \"extra_form_builder\",\n                    \"parameters\": {\n                        \"configuration\": {\n                            \"collection_lapin\": {\n                                \"extra_form_type\": \"extra_form_collection\",\n                                \"options\": {\n                                    \"type\": \"extra_form_builder\",\n                                    \"min_items\": \"{{ '{{ flow_data.data.code[\\'purchase-1_usableCodes\\']|length|default(1) }}' }}\",\n                                    \"max_items\": \"{{ '{{ flow_data.data.code[\\'purchase-1_usableCodes\\']|length|default(10) }}' }}\",\n                                    \"label\": \" \",\n                                    \"options\": {\n                                        \"configuration\": {\n                                            \"miscelaneous_title\": {\n                                                \"extra_form_type\": \"html\",\n                                                \"options\": {\n                                                    \"content\": \"<h2 class='titlePage'><span>Sélectionnez le <span class='lastWord'>modèle</span></span></h2><p class='offerDate'>De votre téléphone</p>\",\n                                                    \"attr\": {\n                                                        \"class\": \"phoneTitle\"\n                                                    }\n                                                }\n                                            },\n                                            \"miscelaneous_notabene\": {\n                                                \"extra_form_type\": \"html\",\n                                                \"options\": {\n                                                    \"content\": \"<p class='notabene'>Si vous ne trouvez pas votre téléphone dans la liste, vous pouvez recevoir un <strong>étui personnalisé</strong>, pour cela cliquez sur \\\"autres\\\".</p><p class='notabene'><strong>La personnalisation de votre coque de téléphone pourra varier légèrement selon le modèle choisi.</strong></p><br><div class='alert_validate' style='color:#D90210;text-transform:initial;'>ATTENTION : si vous considérez que l'image affichée ne correspond à votre pot, nous vous invitons à nous en faire part via le formulaire Contactez-nous, en nous précisant votre code. Nos équipes prendront en compte votre demande dans les meilleurs délais.</div><br><br>\",\n                                                    \"attr\": {\n                                                        \"class\": \"phone\"\n                                                    }\n                                                }\n                                            },\n                                            \"editor\": {\n                                                \"extra_form_type\": \"tms_lapin_editor\",\n                                                \"options\": {\n                                                    \"label_attr\": {\n                                                        \"style\": \"display: none\"\n                                                    },\n                                                    \"attr\": {\n                                                        \"class\": \"editor\"\n                                                    },\n                                                    \"format_filters\": {\n                                                        \"Apple\": {\n                                                           \"iphone 4\": \"case_small\",\n                                                           \"iphone 4S\": \"case_small\",\n                                                           \"iphone 5\": \"case_small\",\n                                                           \"iphone 5S\": \"case_small\",\n                                                           \"iphone SE\": \"case_small\",\n                                                           \"iphone 5C\": \"case_small\",\n                                                           \"iphone 6\": \"case_big\",\n                                                           \"iphone 6S\": \"case_big\",\n                                                           \"iphone 6 Plus\": \"case_big\",\n                                                           \"iphone 6S Plus\": \"case_big\",\n                                                           \"iphone 7\": \"case_big\",\n                                                           \"iphone 7 Plus\": \"case_big\"\n                                                        },\n                                                        \"Blackberry\": {\n                                                           \"z10\": \"case_medium\"\n                                                        },\n                                                        \"HTC\": {\n                                                           \"M9\": \"case_big\"\n                                                        },\n                                                        \"Huawei\": {\n                                                           \"P6\": \"case_medium\",\n                                                           \"Mate 8\": \"case_big\",\n                                                           \"P9 Plus\": \"case_big\"\n                                                        },\n                                                        \"LG\": {\n                                                           \"G5\": \"case_big\"\n                                                        },\n                                                        \"Nokia\": {\n                                                           \"Lumia 950\": \"case_big\"\n                                                        },\n                                                        \"Samsung\": {\n                                                           \"Galaxy A3\":\"case_big\",\n                                                           \"Galaxy A5\":\"case_big\",\n                                                           \"Galaxy A5 2016\":\"case_big\",\n                                                           \"Galaxy A7 2016\":\"case_big\",\n                                                           \"Galaxy A8\":\"case_big\",\n                                                           \"Galaxy Grand 2 g7106\":\"case_big\",\n                                                           \"Galaxy Grand i9082\":\"case_big\",\n                                                           \"Galaxy Galaxy Grand Prime G5306\":\"case_big\",\n                                                           \"Galaxy Galaxy J3\":\"case_big\",\n                                                           \"Galaxy Galaxy J3 2016\":\"case_big\",\n                                                           \"Galaxy Galaxy J5 2016\":\"case_big\",\n                                                           \"Galaxy Galaxy J7 2016\":\"case_big\",\n                                                           \"Galaxy Note2\": \"case_big\",\n                                                           \"Galaxy Note3\": \"case_big\",\n                                                           \"Galaxy Note4\": \"case_big\",\n                                                           \"Galaxy Note5\": \"case_big\",\n                                                           \"Galaxy On5 2016\": \"case_big\",\n                                                           \"Galaxy On5 G550\": \"case_big\",\n                                                           \"Galaxy On7 2016\": \"case_big\",\n                                                           \"Galaxy On7 G600\": \"case_big\",\n                                                           \"Galaxy S3\": \"case_medium\",\n                                                           \"Galaxy S4\": \"case_medium\",\n                                                           \"Galaxy S4 MINI\": \"case_small\",\n                                                           \"Galaxy S5\": \"case_big\",\n                                                           \"Galaxy S5 MINI\": \"case_medium\",\n                                                           \"Galaxy S6\": \"case_big\",\n                                                           \"Galaxy S6 Active\": \"case_big\",\n                                                           \"Galaxy S6 EDGE\": \"case_big\",\n                                                           \"Galaxy S6 EDGE Plus\": \"case_big\",\n                                                           \"Galaxy S7\": \"case_big\",\n                                                           \"Galaxy S7 Active\": \"case_big\",\n                                                           \"Galaxy S7 Edge\": \"case_big\",\n                                                           \"Galaxy S8\": \"case_big\",\n                                                           \"Galaxy S8 Plus\": \"case_big\"\n                                                        },\n                                                        \"Sony\": {\n                                                           \"X\": \"case_big\",\n                                                           \"XA\": \"case_big\",\n                                                           \"Z2\": \"case_big\",\n                                                           \"Z5 Compact\": \"case_medium\",\n                                                           \"Z5 Mini\": \"case_medium\",\n                                                           \"Z5 Premium\": \"case_big\",\n                                                           \"Z5 Plus\": \"case_big\"\n                                                        },\n                                                        \"Autres\":{\n                                                           \"Etui Petit Modèle (7,5 cm x 14,5 cm)\": \"cover_small\",\n                                                           \"Etui Grand Modèle (9 cm x 16,5 cm)\": \"cover_big\"\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                \"events\": {\n                    \"form.pre_set_data\": [\n                        {\n                            \"action\": \"change_data\",\n                            \"parameters\": {\n                                \"fields\": {\n                                    \"collection_lapin|json\": \"{{ '[{% for usableCode in flow_data.retrievedData.code.retrieved_codes %}{ \\\\\"editor\\\\\": { \\\\\"sleeve_url\\\\\": \\\\\"http://media-manager.digifid.r.vb.sfdd78.fr/api/media/{{ usableCode.raw.media_reference }}.png\\\\\" } }{% if not loop.last %},{% endif %}{% endfor %}]' }}\"\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"notify\",\n                            \"name\": \"tuto_editor\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ not flow_data.retrievedData.personalize.tuto_editor }}' }}\",\n                                \"type\": \"modal\",\n                                \"options\": {\n                                    \"title\": \"Comment ça marche ?\",\n                                    \"message\": \"<img class='show-for-medium-up' src='https://media-manager.digifid.fr/api/media/2786408889-1494788482-4d1759a2589722693ddc80c1c2899a2a-761' /><img class='show-for-small-only' src='https://media-manager.digifid.fr/api/media/2786408889-1494788483-09bfaae414040fa279330a6e344e60b6-5416' />\",\n                                    \"actions\": [\n                                        {\n                                            \"name\": \"suivant\",\n                                            \"href\": \"#\",\n                                            \"attr\": {\n                                                \"class\": \"close-reveal-modal help button\",\n                                                \"arial-label\": \"Close\"\n                                            }\n                                        }\n                                    ]\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        \"proof\": {\n            \"type\": \"form\",\n            \"options\": {\n                \"title\": \"Confirmez votre <span class='lastWord'>achat</span>\",\n                \"display_title\": true,\n                \"previous_options\": {\"label\": \"Précédent\"},\n                \"js\": \"$(function() { var buttonPressed; $('button[type=submit]').click(function(){buttonPressed=$(this).attr('name')});$('.confirm_purchase').on('submit', function(event) {if(buttonPressed == 'idci_step_navigator[_path_0]'){event.preventDefault();event.stopPropagation();var $modal = $('<div class=\\\"reveal-modal small\\\" data-reveal role=\\\"dialog\\\"><div class=\\\"modal-box\\\"><p class=\\\"titleModal\\\">Attention !</p><div class=\\\"content\\\">Merci de vérifier la conformité de votre ticket de caisse<br />avant de valider votre participation.</div><div class=\\\"actions\\\"></div></div></div>');var $noButton = $('<a href=\\\"#\\\" class=\\\"button button-black\\\">Modifier</a>');var $yesButton = $('<a href=\\\"#\\\" class=\\\"button\\\">Valider</a>');        $noButton.on('click', function (e) {$modal.foundation('reveal', 'close');});$yesButton.on('click', function (e) {$('body').addClass('loading');$('.confirm_purchase').unbind('submit');$('.confirm_purchase .next').trigger('click');$modal.foundation('reveal', 'close');});$modal.find('.actions').append($yesButton);$modal.find('.actions').append($noButton);$modal.foundation('reveal', 'open');}}) });$('ul.errors + input').one('focus', function(){$(this).prev().remove();});$('form.confirm_purchase .proof').on('change', function() {$('form.confirm_purchase button.next').prop('disabled', false);});\",\n                \"attr\": {\n                    \"class\": \"confirm_purchase\",\n                    \"id\": \"proofTicket\"\n                },\n                \"@builder\": {\n                    \"worker\": \"extra_form_builder\",\n                    \"parameters\": {\n                        \"configuration\": {\n                            \"notice-1\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<h3 class='titleStep'>Télécharger votre ticket de caisse <a href='#'data-reveal-id='proofModal1'><img src=\\\"/bundles/themes/winnie.lapin/tmswebportalbundle/images/help_icon.png\\\" alt=\\\"Page info\\\" title=\\\"page info\\\" width=\\\"17\\\" height=\\\"16\\\" /></a></h3><div id='proofModal1' class='reveal-modal small' data-reveal aria-labelledby='modalTitle' aria-hidden='true' role='dialog'><p class='titleModal'>Ma preuve d&#146;achat</p><div class='leftModal'><ul class='modal_notice1'><li>Depuis un ordinateur, cliquez sur « Parcourir » pour séléctionner l&#146;image de votre ticket de caisse que vous avez au préalable scanné ou photographié.</li><li>Depuis un smartphone, photographiez directement votre ticket de caisse ou séléctionnez-le dans votre galerie photo.</li></ul><br /><p>Votre fichier ne doit pas dépasser 5Mo et être au format JPG, PNG, GIF, PDF ou TIFF.</p><br /><p><strong>Important</strong> : Si votre ticket de caisse est trop long, pliez-le en accordéon de façon à faire apparaître le haut et le bas du ticket, et vos achats.</p><br /></div><div class='rightModal'><img src='https://media-manager.digifid.fr/api/media/2786408889-1494788483-abb1af434be0534d9e467e48abbe6cf4-8419'/></div><a class='close-reveal-modal help button' aria-label='Close'>Fermer</a></div></p><p class='preuve_achat'>Veuillez télécharger la preuve d&#146;achat dans son intégralité en veillant à ce que les éléments suivants soient bien lisibles : </p><ul class ='notice-list1'><li>Le nom de votre point de vente</li><li>La date et l'heure de votre achat</li><li>Le nom du produit acheté ainsi que son montant (TTC)</li><li>Le montant total (TTC) de votre preuve d&#146;achat</li></ul>\",\n                                    \"attr\": {\n                                        \"class\": \"noticeRed notcenter\"\n                                    }\n                                }\n                            },\n                            \"purchase-1_proof-1\": {\n                                \"extra_form_type\": \"tms_media_upload\",\n                                \"options\": {\n                                    \"label\": \"<span class='important' style='font-style:italic' >Important : Si votre ticket de caisse est trop long, pliez-le en accordéon de façon à faire apparaître le haut et le bas du ticket, et vos achats.</span><br><br><div class='mandatory'><p class='size-format' style='font-style:italic'>Formats acceptés: jpeg, png, gif, pdf, tiff<br>Poids maximum: 5Mo</p><p style='color:red; font-style:italic'>Vous ne pouvez utiliser votre ticket de caisse qu’une seule fois pour bénéficier de l&acute;offre.<br>Si vous avez fait plusieurs achats sur le même ticket de caisse, veuillez renseigner tous les codes lors de votre participation.</p></div>\",\n                                    \"required\": true,\n                                    \"metadata\": {\n                                        \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                        \"offer\": \"{{ participation.offer.reference }}\"\n                                    },\n                                    \"attr\": {\n                                        \"class\": \"proof buttonStroke\",\n                                        \"placeholder\": \"Télécharger un ticket de caisse|Modifier l'image\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"tms_media_upload_not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de télécharger une photo de votre ticket de caisse.\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"tms_media_upload_file\",\n                                        \"options\": {\n                                            \"maxSize\": \"5M\",\n                                            \"maxSizeMessage\": \"Poids incorrect : Le poids de votre fichier dépasse la limite autorisée de 5Mo. Merci de réduire son poids et recommencer.\",\n                                            \"uploadIniSizeErrorMessage\": \"Poids incorrect : Le poids de votre fichier dépasse la limite autorisée de 5Mo. Merci de réduire son poids et recommencer.\",\n                                            \"uploadFormSizeErrorMessage\": \"Poids incorrect : Le poids de votre fichier dépasse la limite autorisée de 5Mo. Merci de réduire son poids et recommencer.\",\n                                            \"mimeTypes\": [\n                                                \"image/png\",\n                                                \"image/jpeg\",\n                                                \"image/gif\",\n                                                \"image/tiff\",\n                                                \"application/pdf\"\n                                            ],\n                                            \"mimeTypesMessage\": \"Format non reconnu : Le format de votre fichier est incorrect. Merci de bien vérifier la liste des formats acceptés.\"\n                                        }\n                                    }\n                                ]\n                            }\n                        }\n                    }\n                },\n                \"events\": {\n                    \"form.post_set_data\": [\n                        {\n                            \"action\": \"conditional_stop_navigation\",\n                            \"name\": \"is_max_order\",\n                            \"parameters\": {\n                                \"final_destination\": \"/\",\n                                \"rules\": {\n                                    \"order_limit\": {\n                                        \"limit\": 2,\n                                        \"query\": {\n                                            \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                            \"participation\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(\\'\\') }}' }}\"\n                                        }\n                                    }\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"notify\",\n                            \"parameters\": {\n                                \"type\": \"modal\",\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.proof.is_max_order }}' }}\",\n                                \"options\": {\n                                    \"title\": \"Information !\",\n                                    \"message\": \"Vous avez atteint le nombre limite de modifications de votre demande.\",\n                                    \"actions\": [\n                                        {\n                                            \"name\": \"OK\",\n                                            \"href\": \"#\",\n                                            \"attr\": {\n                                                \"class\": \"close-reveal-modal help button\",\n                                                \"arial-label\": \"Close\"\n                                            }\n                                        }\n                                    ]\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"conditional_stop_navigation\",\n                            \"name\": \"is_outdated_participation\",\n                            \"parameters\": {\n                                \"final_destination\": \"/\",\n                                \"rules\": {\n                                    \"participation_limit\": {\n                                        \"limit\": 1,\n                                        \"query\": {\n                                            \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                            \"id\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(\\'\\') }}' }}\",\n                                            \"updated_at\": \"<~~{{ '-3 days'|date('Y-m-d') }}T00:00:00CET\"\n                                        }\n                                    }\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"notify\",\n                            \"parameters\": {\n                                \"type\": \"modal\",\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.proof.is_outdated_participation }}' }}\",\n                                \"options\": {\n                                    \"title\": \"Information !\",\n                                    \"message\": \"Vous avez dépassé le délai autorisé pour modifier votre demande.\",\n                                    \"actions\": [\n                                        {\n                                            \"name\": \"OK\",\n                                            \"href\": \"#\",\n                                            \"attr\": {\n                                                \"class\": \"close-reveal-modal help button\",\n                                                \"arial-label\": \"Close\"\n                                            }\n                                        }\n                                    ]\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        \"identity\": {\n            \"type\": \"form\",\n            \"options\": {\n                \"title\": \"Renseignez vos <span class='lastWord'>coordonnées</span>\",\n                \"previous_options\": {\"label\": \"Précédent\"},\n                \"attr\": {\n                    \"class\": \"identity\",\n                    \"id\": \"identityForm\"\n                },\n                \"js\": \"$('form.identity').on('submit', function(){ $('body').addClass('loading');});$('ul.errors + input').one('focus', function(){$(this).prev().remove();});\",\n                \"display_title\": true,\n                \"@builder\": {\n                    \"worker\": \"extra_form_builder\",\n                    \"parameters\": {\n                        \"configuration\": {\n                            \"spacer\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"\",\n                                    \"attr\": {\n                                        \"class\": \"split_line half_column\"\n                                    }\n                                }\n                            },\n                            \"identity_title\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<h3>Vos coordonnées</h3>\"\n                                }\n                            },\n                            \"identity_gender\": {\n                                \"extra_form_type\": \"choice\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"choices\": {\n                                        \"M.\": \"M.\",\n                                        \"Mme\": \"Mme\"\n                                    },\n                                    \"empty_value\": \"Civilité*\"\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"veuillez sélectionner la civilité\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_lastName\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"max_length\" : 25,\n                                    \"pattern\": \"^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,25}$\",\n                                    \"attr\": {\n                                        \"placeholder\": \"Nom*\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"saisie du nom obligatoire\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,25}$#\",\n                                            \"match\": true,\n                                            \"message\": \"Merci de renseigner correctement votre nom.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_firstName\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"max_length\" : 20,\n                                    \"pattern\": \"^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,20}$\",\n                                    \"attr\": {\n                                        \"placeholder\": \"Prénom*\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"saisie du prénom obligatoire\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç ]{1,20}$#\",\n                                            \"match\": true,\n                                            \"message\": \"Merci de renseigner correctement votre prénom.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_birthdate\": {\n                                \"extra_form_type\": \"tms_birthday\",\n                                \"options\": {\n                                    \"label\": \"Date de naissance\",\n                                    \"required\": 1,\n                                    \"empty_value\": {\n                                       \"day\": \"Jour\",\n                                       \"month\": \"Mois\",\n                                       \"year\": \"Année\"\n                                    },\n                                    \"format\": \"dd MM yyyy\",\n                                    \"start_on\": \"1920\",\n                                    \"end_on\": \"{{ 'now - 18years'|date('Y') }}\",\n                                    \"widget\": \"choice\",\n                                    \"input\": \"string\",\n                                    \"invalid_message\": \"Votre date de naissance n'est pas correctement renseignée.\",\n                                    \"attr\": {\n                                        \"class\": \"birthdate\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de renseigner votre date de naissance\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"tms_age\",\n                                        \"options\": {\n                                            \"format\": \"Y-m-d\",\n                                            \"min\": 18,\n                                            \"minMessage\": \"Cette offre est réservée aux personnes majeures. Vous ne pouvez pas y participer.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_email\": {\n                                \"extra_form_type\": \"repeated\",\n                                \"options\": {\n                                    \"type\": \"email\",\n                                    \"invalid_message\": \"Les adresses email doivent correspondre\",\n                                    \"pattern\": \"^[A-Za-z0-9]{1,}([_|\\\\.|-]{1}[A-Za-z0-9]{1,})*@[A-Za-z0-9]{1,}([\\\\.|-]{1}[A-Za-z0-9]{1,})*[\\\\.]{1}[A-Za-z]{2,}$\",\n                                    \"attr\": {\n                                        \"class\": \"split_line half_column\"\n                                    },\n                                    \"first_options\": {\n                                        \"label\": \" \",\n                                        \"attr\": {\n                                            \"placeholder\": \"E-mail*\"\n                                        }\n                                    },\n                                    \"second_options\": {\n                                        \"label\": \" \",\n                                        \"attr\": {\n                                            \"placeholder\": \"Confirmation email*\"\n                                        }\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de renseigner votre adresse email\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^[A-Za-z0-9]{1,}([_|\\\\.|-]{1}[A-Za-z0-9]{1,})*@[A-Za-z0-9]{1,}([\\\\.|-]{1}[A-Za-z0-9]{1,})*[\\\\.]{1}[A-Za-z]{2,}$#\",\n                                            \"match\": true,\n                                            \"message\": \"Merci de renseigner correctement votre adresse email.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"shipping_title\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<h3>Votre adresse de livraison</h3>\"\n                                }\n                            },\n                            \"identity_address1\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"attr\": {\n                                        \"placeholder\": \"Adresse*\"\n                                    },\n                                    \"max_length\" : 38\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de renseigner votre adresse\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_address2\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"attr\": {\n                                        \"placeholder\": \"Complément adresse\"\n                                    },\n                                    \"required\": false,\n                                    \"max_length\" : 38\n                                }\n                            },\n                            \"identity_zipCode\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"required\": 1,\n                                    \"max_length\": 5,\n                                    \"pattern\": \"^(([0-8][0-9])|(9[0-5]))[0-9]{3}$\",\n                                    \"attr\": {\n                                        \"title\": \"L'offre est ouverte à la France Métropolitaine (Corse incluse)\",\n                                        \"placeholder\": \"Code postal*\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de renseigner votre code postal\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^(([0-8][0-9])|(9[0-5]))[0-9]{3}$#\",\n                                            \"match\": true,\n                                            \"message\": \"L'offre est ouverte à la France Métropolitaine (Corse incluse)\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_city\": {\n                                \"extra_form_type\": \"text\",\n                                \"options\": {\n                                    \"label\": \" \",\n                                    \"attr\": {\n                                        \"class\": \"split_line\",\n                                        \"placeholder\": \"Ville*\"\n                                    }\n                                },\n                                \"constraints\": [\n                                     {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de renseigner votre ville\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^[A-Za-z-àâäééèêëiîïoôöuùûüç' ]{1,33}$#\",\n                                            \"match\": true,\n                                            \"message\": \"Merci de renseigner correctement votre ville.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_cguAccepted\": {\n                                \"extra_form_type\": \"checkbox\",\n                                \"options\": {\n                                    \"required\": true,\n                                    \"label\": \"J'accepte les <a href='/content/cgu_miel_lapin'>modalités</a>.\"\n                                },\n                                \"constraints\": [\n                                     {\n                                        \"extra_form_constraint\": \"true\",\n                                        \"options\": {\n                                            \"message\": \"Merci d'accepter les termes et conditions de l'offre.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"identity_optinEmailNewsletter\": {\n                                \"extra_form_type\": \"checkbox\",\n                                \"options\": {\n                                    \"required\": false,\n                                    \"label\": \"Je souhaite recevoir des bons plans exclusifs et promos de la part de miel® et des autres marques du groupe winnie (Kinder, Tic Tac, winnie Rocher…)\",\n                                    \"attr\": {\n                                        \"class\": \"newsletter\"\n                                    }\n                                }\n                            },\n                            \"mandatory\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"* Champs obligatoires\",\n                                    \"attr\": {\n                                        \"class\": \"mandatory\"\n                                    }\n                                }\n                            },\n                            \"html1\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"attr\": {\n                                        \"class\": \"alert_validate\"\n                                    },\n                                    \"content\": \"<br>ATTENTION : Nous vous rappelons que l’adresse de livraison n’est pas modifiable après validation.\"\n                                }\n                            },\n                            \"html2\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"attr\": {\n                                        \"class\": \"content\"\n                                    },\n                                    \"content\": \"Les informations que vous nous communiquez sont recueillies par Idci pour le compte de la société winnie France Commerciale (Responsable du Traitement). Vos données sont collectées pour les besoins de gestion de la présente offre et pourront également être utilisées afin de vous faire parvenir, uniquement si vous l’avez accepté, des bons plans exclusifs et promos de la part de miel® et des autres marques du groupe winnie (Kinder, Tic Tac, winnie Rocher…) ainsi que pour le traitement à des fins statistiques, de sondage et d’enquête de marché relatives à nos produits. Conformément à la Loi Informatique et Libertés du 6 janvier 1978 modifiée, vous pouvez à tout moment et gratuitement exercer vos droits d’accès, de rectification et de retrait des données personnelles vous concernant en écrivant à : winnie FRANCE COMMERCIALE – Service Consommateurs - 18 rue Jacques Monod - 76130 Mont Saint Aignan.\"\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        },\n        \"end\": {\n            \"type\": \"html\",\n            \"options\": {\n                \"attr\": {\"class\": \"confirmParticipation\"},\n                \"prevent_previous\": true,\n                \"title\": \"Merci de votre participation\",\n                \"content\":\"<br><br><p>Votre participation n° {{ '{{ flow_data.retrievedData.identity.retrieved_participation.code }}' }} a bien été prise en compte</p><p>Nous vous rappelons que celle-ci est soumise à vérification.<br />Si les éléments fournis sont valides, vous recevrez votre coque de portable ou votre étui unique<br />dans un délai de 6 à 8 semaines.</p><p>Surveillez votre boîte mail, vous recevrez un mail de confirmation de participation.</p>\"\n            }\n        },\n        \"questions\": {\n            \"type\": \"form\",\n            \"options\": {\n                \"prevent_previous\": true,\n                \"title\": \"Votre avis <span class='lastWord'>compte</span> !\",\n                \"attr\": {\n                    \"class\": \"questions\",\n                    \"id\": \"questions\"\n                },\n                \"display_title\": true,\n                \"@builder\": {\n                    \"worker\": \"extra_form_builder\",\n                    \"parameters\": {\n                        \"configuration\": {\n                            \"question_title\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<p class='offerDate'>Merci de répondre aux questions suivantes</p>\",\n                                    \"attr\": {\n                                        \"class\": \"text-center\"\n                                    }\n                                }\n                            },\n                            \"question_info\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<p>Merci de votre participation ! Nous aimerons avoir votre avis sur notre opération « Mon pot unique, ma coque miel ® » au travers d'une enquête de satisfaction qui prendra que quelques minutes. Vos réponses resteront bien sûr confidentielles et seront analysées de manière anonyme. </p>\",\n                                    \"attr\": {\n                                        \"class\": \"question-info blockQuestion\"\n                                    }\n                                }\n                            },\n                            \"question1\": {\n                                \"extra_form_type\": \"integer\",\n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>1</span>Si vous deviez donner une note à la simplicité de participation à l'opération « Mon pot unique, ma coque miel ® » (5 étant la note la plus élevée\",\n                                    \"attr\": {\n                                                   \"min\": 1,\n                                                   \"max\": 5\n                                    },\n                                    \"pattern\": \"^[1-5]$\"\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de donner votre avis\"\n                                        }\n                                    },\n                                    {\n                                        \"extra_form_constraint\": \"regex\",\n                                        \"options\": {\n                                            \"pattern\": \"#^[1-5]$#\",\n                                            \"match\": true,\n                                            \"message\": \"Merci de répondre correctement à la question.\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question2\": {\n                                \"extra_form_type\": \"textarea\",\n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>2</span>Qu'est-ce qui vous a plu dans l'opération « Mon pot unique, ma coque miel ® » ?\",\n                                    \"attr\" : {\"class\": \"blockQuestion\"},\n                                    \"label_attr\": {\n                                        \"class\": \"mtext-in\"\n                                    },\n                                    \"attr\": {\n                                        \"class\": \"message-in\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de donner votre avis\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question3\": {\n                                \"extra_form_type\": \"textarea\",\n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>3</span>Qu'est-ce qui vous a déplu dans l'opération « Mon pot unique, ma coque miel ® » ?\",\n                                    \"label_attr\": {\n                                        \"class\": \"mtext-out\"\n                                    },\n                                    \"attr\": {\n                                        \"class\": \"message-out\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"Merci de donner votre avis\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question4\": {\n                                \"extra_form_type\": \"extra_form_builder\",\n                                \"options\": {\n                                    \"label\": \"Dites-nous dans quelle mesure vous êtes d'accord avec les affirmations suivantes<br/>Echelle en 5 points: 5. Tout à fait d'accord et 1. Pas du tout d'accord\",\n                                    \"attr\" : {\"class\": \"questionGroup\"},\n                                    \"configuration\": {\n                                        \"item1\": {\n                                            \"extra_form_type\": \"integer\",\n                                            \"options\": {\n                                                \"label\": \"J'ai trouvé facilement l'onglet sur le site miel.com pour participer à l'opération « Mon pot unique, ma coque miel ® »\",\n                                                \"attr\": {\n                                                   \"min\": 1,\n                                                   \"max\": 5\n                                                },\n                                                \"pattern\": \"^[1-5]$\"\n                                            },\n                                            \"constraints\": [\n                                                {\n                                                    \"extra_form_constraint\": \"not_blank\",\n                                                    \"options\": {\n                                                        \"message\": \"Merci de donner votre avis\"\n                                                    }\n                                                },\n                                                {\n                                                    \"extra_form_constraint\": \"regex\",\n                                                    \"options\": {\n                                                        \"pattern\": \"#^[1-5]$#\",\n                                                        \"match\": true,\n                                                        \"message\": \"Merci de répondre correctement à la question.\"\n                                                    }\n                                                }\n                                            ]\n                                        },\n                                        \"item2\": {\n                                            \"extra_form_type\": \"integer\",\n                                            \"options\": {\n                                                \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>4</span>J'ai trouvé facilement où rentrer mon code unique sur le site miel.com\",\n                                                \"attr\": {\n                                                   \"min\": 1,\n                                                   \"max\": 5\n                                                },\n                                                \"pattern\": \"^[1-5]$\"\n                                            },\n                                            \"constraints\": [\n                                                {\n                                                    \"extra_form_constraint\": \"not_blank\",\n                                                    \"options\": {\n                                                        \"message\": \"Merci de donner votre avis\"\n                                                    }\n                                                },\n                                                {\n                                                    \"extra_form_constraint\": \"regex\",\n                                                    \"options\": {\n                                                        \"pattern\": \"#^[1-5]$#\",\n                                                        \"match\": true,\n                                                        \"message\": \"Merci de répondre correctement à la question.\"\n                                                    }\n                                                }\n                                            ]\n                                        },\n                                        \"item3\": {\n                                            \"extra_form_type\": \"integer\",\n                                            \"options\": {\n                                                \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>5</span>J'ai trouvé le site miel.com clair et compréhensible\",\n                                                \"attr\": {\n                                                   \"min\": 1,\n                                                   \"max\": 5\n                                                },\n                                                \"pattern\": \"^[1-5]$\"\n                                            },\n                                            \"constraints\": [\n                                                {\n                                                    \"extra_form_constraint\": \"not_blank\",\n                                                    \"options\": {\n                                                        \"message\": \"Merci de donner votre avis\"\n                                                    }\n                                                },\n                                                {\n                                                    \"extra_form_constraint\": \"regex\",\n                                                    \"options\": {\n                                                        \"pattern\": \"#^[1-5]$#\",\n                                                        \"match\": true,\n                                                        \"message\": \"Merci de répondre correctement à la question.\"\n                                                    }\n                                                }\n                                            ]\n                                        },\n                                        \"item4\": {\n                                            \"extra_form_type\": \"integer\",\n                                            \"options\": {\n                                                \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>6</span>J'ai trouvé que la personnalisation de la coque de smartphone était conforme à mes attentes\",\n                                                \"attr\": {\n                                                   \"min\": 1,\n                                                   \"max\": 5\n                                                },\n                                                \"pattern\": \"^[1-5]$\"\n                                            },\n                                            \"constraints\": [\n                                                {\n                                                    \"extra_form_constraint\": \"not_blank\",\n                                                    \"options\": {\n                                                        \"message\": \"Merci de donner votre avis\"\n                                                    }\n                                                },\n                                                {\n                                                    \"extra_form_constraint\": \"regex\",\n                                                    \"options\": {\n                                                        \"pattern\": \"#^[1-5]$#\",\n                                                        \"match\": true,\n                                                        \"message\": \"Merci de répondre correctement à la question.\"\n                                                    }\n                                                }\n                                            ]\n                                        }\n                                    }\n                                }\n                            },\n                            \"question5\": {\n                                \"extra_form_type\": \"choice\",\n                                \"options\": {\n                                    \"attr\" : {\"class\": \"choiceOperation\"},\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>7</span>Avez-vous participé aux opérations miel suivantes ?\",\n                                    \"label_attr\": {\n                                        \"class\": \"question\"\n                                    },\n                                    \"choices\": {\n                                        \"Mon Mug miel\": \"Mon Mug miel\",\n                                        \"Mon Ballon miel\": \"Mon Ballon miel\",\n                                        \"Ma Lampe miel\": \"Ma Lampe miel\",\n                                        \"Mon Mug B-Ready\": \"Mon Mug B-Ready\",\n                                        \"Je m'en souviens plus\": \"Je m'en souviens plus\",\n                                        \"Non, je n'ai participé à aucune de ces offres\": \"Non, je n'ai participé à aucune de ces offres\"\n                                    },\n                                    \"expanded\": 1,\n                                    \"multiple\": 1\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"veuillez sélectionner une option\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question6\": {\n                                \"extra_form_type\": \"choice\",                                \n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>8</span>Etes vous ?\",\n                                    \"attr\" : {\"class\": \"blockQuestion\"},\n                                    \"choices\": {\n                                        \"homme\": \"Un homme\",\n                                        \"femme\": \"Une femme\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"veuillez sélectionner votre choix\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question7\": {\n                                \"extra_form_type\": \"choice\",\n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>9</span>Quel âge avez-vous ?\",\n                                    \"attr\" : {\"class\": \"blockQuestion\"},\n                                    \"choices\": {\n                                        \"18-24\": \"18-24 ans\",\n                                        \"25-34\": \"25-34 ans\",\n                                        \"35-44\": \"35-44 ans\",\n                                        \"45-59\": \"45-59 ans\",\n                                        \"60 plus\": \"60 ans et plus\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"veuillez sélectionner votre choix\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question8\": {\n                                \"extra_form_type\": \"choice\",\n                                \"options\": {\n                                    \"label\": \"<span class=\\\"numberQuestion\\\"style='background:#ffe864'>10</span>Avez-vous des enfants vivant dans votre foyer ?\",\n                                    \"attr\" : {\"class\": \"blockQuestion\"},\n                                    \"choices\": {\n                                        \"Oui\": \"Oui\",\n                                        \"Non\": \"Non\"\n                                    }\n                                },\n                                \"constraints\": [\n                                    {\n                                        \"extra_form_constraint\": \"not_blank\",\n                                        \"options\": {\n                                            \"message\": \"veuillez sélectionner votre choix\"\n                                        }\n                                    }\n                                ]\n                            },\n                            \"question_end\": {\n                                \"extra_form_type\": \"html\",\n                                \"options\": {\n                                    \"content\": \"<p>Merci d'avoir pris le temps de répondre à ce questionnaire et à bientôt sur miel.com !</p>\",\n                                    \"attr\": {\n                                        \"class\": \"question-end blockQuestion\"\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    },\n    \"paths\": [\n        {\n           \"type\": \"conditional_destination\",\n           \"options\": {\n               \"source\": \"home\",\n               \"destinations\": {\n                   \"proof\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\"\n               },\n               \"default_destination\": \"code\",\n               \"next_options\": {\n                   \"label\": \"Je commande ma coque de portable miel ®\",\n                   \"attr\": {\n                       \"class\": \"next-lapin\"\n                   }\n               }\n            }\n        },\n        {\n            \"type\": \"single\",\n            \"options\": {\n                \"source\": \"code\",\n                \"destination\": \"personalize\",\n                \"next_options\": {\n                    \"label\": \"Valider\",\n                    \"attr\": {\n                        \"class\": \"next\"\n                    }\n                },\n                \"events\": {\n                    \"form.post_bind\": [\n                        {\n                            \"action\": \"retrieve_codes\",\n                            \"name\": \"retrieved_codes\",\n                            \"parameters\": {\n                                \"codespace\": \"winnielapin\",\n                                \"codes\": \"{{ '{{ flow_data.data.code[\\'purchase-1_usableCodes\\']|json_encode|default([]) }}' }}\"\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        {\n            \"type\": \"single\",\n            \"options\": {\n                \"source\": \"personalize\",\n                \"destination\": \"proof\",\n                \"next_options\": {\n                    \"label\": \"Valider\",\n                    \"attr\": {\n                        \"class\": \"next\"\n                    }\n                },\n                \"events\": {\n                    \"form.post_bind\": [\n                        {\n                            \"action\": \"generate_lapin_images\",\n                            \"name\": \"lapin_previews\",\n                            \"parameters\": {\n                                \"collection_data\": \"{{ '{{ flow_data.data.personalize.collection_lapin|json_encode() }}' }}\"\n                            }\n                        },\n                        {\n                            \"action\": \"notify\",\n                            \"name\": \"preview_editor\",\n                            \"parameters\": {\n                                \"type\": \"modal\",\n                                \"options\": {\n                                    \"title\": \"Aperçu de votre coque unique<br />personnalisée\",\n                                    \"message\": \"<ul class=\\\"slider\\\" data-orbit data-options=\\\"pause_on_hover:false;slide_number:false; timer_speed: 4000;\\\">{{ '{% for preview in flow_data.retrievedData.personalize.lapin_previews %}' }} <li class=\\\"{{ '{{ preview.editor_data.format }}' }}\\\"><img alt=\\\"{{ '{{ preview.editor_data.brand }} - {{ preview.editor_data.model }}' }}\\\" src=\\\"data:image/png;base64,{{ '{{ preview.image }}' }}\\\" /><span class=\\\"coqueLayout\\\"></span><p>{{ '{{ preview.editor_data.brand }} - {{ preview.editor_data.model }}' }}</p></li> {{ '{% endfor %}' }}</ul><p class=\\\"notabene\\\"><strong>La personnalisation de votre coque de téléphone pourra varier légèrement selon le modèle choisi.</strong></p><br><div class='alert_validate' style='color:#D90210;text-transform:initial;'>ATTENTION : si vous considérez que l'image affichée ne correspond à votre pot, nous vous invitons à nous en faire part via le formulaire Contactez-nous, en nous précisant votre code. Nos équipes prendront en compte votre demande dans les meilleurs délais.</div><br><br><script> $(document).foundation();jQuery(document).ready(function($){$('.update').on('click', function(event) {$(\\\"#idci_step_navigator__back\\\").click()})}); </script>\",\n                                    \"actions\": [\n                                        {\n                                            \"name\": \"Valider\",\n                                            \"href\": \"#\",\n                                            \"attr\": {\n                                                \"class\": \"button close-reveal-modal\",\n                                                \"arial-label\": \"Close\"\n                                            }\n                                        },\n                                        {\n                                            \"name\": \"Modifier\",\n                                            \"href\": \"#\",\n                                            \"attr\": {\n                                                \"class\": \"button button-black update\"\n                                            }\n                                        }\n                                    ]\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        {\n            \"type\": \"conditional_destination\",\n            \"options\": {\n                \"source\": \"proof\",\n                \"destinations\": {\n                    \"end\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\"\n                },\n                \"default_destination\": \"identity\",\n                \"next_options\": {\n                    \"label\": \"Valider\",\n                    \"attr\": {\n                        \"class\": \"next outside\"\n                    }\n                },\n                \"events\": {\n                    \"form.post_bind\": [\n                        {\n                            \"action\": \"create_order\",\n                            \"name\": \"created_order\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\",\n                                \"operation\": \"{{ participation.offer.operation.reference }}\",\n                                \"products\": [\n                                    {\n                                        \"id\": \"{{ participation.offer.products.0.id }}\",\n                                        \"name\": \"{{ participation.offer.products.0.name }}\",\n                                        \"quantity\": \"{{ '{{ flow_data.remindedData.code[\\'purchase-1_usableCodes\\']|length|default(1) }}' }}\",\n                                        \"prices\": [],\n                                        \"kit\": [],\n                                        \"raw\": \"{}\"\n                                    }\n                                ]\n                            }\n                        },\n                        {\n                            \"action\": \"create_participation\",\n                            \"name\": \"created_participation\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\",\n                                \"id\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id }}' }}\",\n                                \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                \"offer\": \"{{ participation.offer.reference }}\",\n                                \"operation\": \"{{ participation.offer.operation.reference }}\",\n                                \"source\": \"digifid - webConsumerApp - winnielapin.preprod.odr.fr\",\n                                \"order\": \"{{ '{{ flow_data.retrievedData.proof.created_order.id }}' }}\",\n                                \"processing_state\": \"H_Manual\",\n                                \"benefits\": [\"{{ participation.offer.benefits.0.id }}\"],\n                                \"merge_raw_data\": \"1\"\n                            }\n                        },\n                        {\n                            \"action\": \"confirm_order\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\",\n                                \"order_id\": \"{{ '{{ flow_data.retrievedData.proof.created_order.id }}' }}\"\n                            }\n                        },\n                        {\n                            \"action\": \"purge_flow_data\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\",\n                                \"steps\": {\n                                    \"proof\": {\n                                        \"retrieved_data\": [\n                                            \"created_order\",\n                                            \"update_product_order\",\n                                            \"confirm_order\"\n                                        ]\n                                    }\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"allow_redo_participation\",\n                            \"parameters\": {\n                                \"logical_expression\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(false) ? 1 : 0 }}' }}\",\n                                \"participation_id\": \"{{ '{{ flow_data.retrievedData.proof.created_participation.id }}' }}\"\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        {\n            \"type\": \"single\",\n            \"options\": {\n                \"source\": \"identity\",\n                \"destination\": \"end\",\n                \"next_options\": {\n                    \"label\": \"Valider\",\n                    \"attr\": {\n                        \"class\": \"next outside\"\n                    }\n                },\n                \"events\": {\n                    \"form.post_bind\": [\n                        {\n                            \"action\": \"purge_flow_data\",\n                            \"parameters\": {\n                                \"steps\": {\n                                    \"home\": {\n                                        \"retrieved_data\": []\n                                    },\n                                    \"code\": {\n                                        \"retrieved_data\": []\n                                    },\n                                    \"proof\": {\n                                        \"retrieved_data\": []\n                                    },\n                                    \"personalize\": {\n                                        \"retrieved_data\": []\n                                    }\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"generate_lapin_images\",\n                            \"name\": \"lapin_toprint\",\n                            \"parameters\": {\n                                \"collection_data\": \"{{ '{{ flow_data.data.personalize.collection_lapin|json_encode() }}' }}\",\n                                \"output_mode\": \"tms_media\",\n                                \"output_format\": \"pdf\",\n                                \"output_margin\": 1,\n                                \"resolution\": 200\n                            }\n                        },\n                        {\n                            \"action\": \"create_order\",\n                            \"name\": \"created_order\",\n                            \"parameters\": {\n                                \"operation\": \"{{ participation.offer.operation.reference }}\",\n                                \"products\": [\n                                    {\n                                        \"id\": \"{{ participation.offer.products.0.id }}\",\n                                        \"name\": \"{{ participation.offer.products.0.name }}\",\n                                        \"quantity\": \"{{ '{{ flow_data.data.code[\\'purchase-1_usableCodes\\']|length|default(1) }}' }}\",\n                                        \"prices\": [],\n                                        \"kit\": [],\n                                        \"raw\": \"{}\"\n                                    }\n                                ]\n                            }\n                        },\n                        {\n                            \"action\": \"create_participation\",\n                            \"name\": \"created_participation\",\n                            \"parameters\": {\n                                \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                \"offer\": \"{{ participation.offer.reference }}\",\n                                \"operation\": \"{{ participation.offer.operation.reference }}\",\n                                \"source\": \"digifid - webConsumerApp - winnielapin.preprod.odr.fr\",\n                                \"processing_state\": \"Synchronous\",\n                                \"order\": \"{{ '{{ flow_data.retrievedData.identity.created_order.id }}' }}\",\n                                \"benefits\": [\"{{ participation.offer.benefits.0.id }}\"]\n                            }\n                        },\n                        {\n                            \"action\": \"process_eligibility\",\n                            \"parameters\": {\n                                \"customer\": \"{{ participation.offer.customer.reference }}\",\n                                \"participation_id\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id }}' }}\",\n                                \"message\": \"\"\n                            }\n                        },\n                        {\n                            \"action\": \"confirm_order\",\n                            \"parameters\": {\n                                \"order_id\": \"{{ '{{ flow_data.retrievedData.identity.created_order.id }}' }}\"\n                            }\n                        },\n                        {\n                            \"action\": \"retrieve_participation\",\n                            \"name\": \"retrieved_participation\",\n                            \"parameters\": {\n                                 \"queries\": {\n                                    \"id\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(null) }}' }}\"\n                                 }\n                            }\n                        },\n                        {\n                            \"action\": \"retrieve_document\",\n                            \"name\": \"retrieved_document\",\n                            \"parameters\": {\n                                 \"document_id\": \"winnie-lapin-confirmation-participation\",\n                                 \"mode\": \"content\",\n                                 \"data\": {\n                                    \"participation\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id|default(null) }}' }}\",\n                                    \"firstname\": \"{{ '{{ flow_data.data.identity.identity_firstName }}' }}\"\n                                 },\n                                 \"options\": {\n                                    \"format\": \"html\"\n                                 }\n                            }\n                        },\n                        {\n                            \"action\": \"reserve_product\",\n                            \"name\": \"reserved_product\",\n                            \"parameters\": {\n                                \"stockspace\": \"winnielapin\",\n                                \"id\": \"{{ participation.offer.products.0.id }}\",\n                                \"origin\": \"digifid - webConsumerApp - winnielapin.preprod.odr.fr\",\n                                \"quantity\": \"{{ '{{ flow_data.data.code[\\'purchase-1_usableCodes\\']|length|default(1) }}' }}\"\n                            }\n                        },\n                        {\n                            \"action\": \"notify\",\n                            \"name\": \"notify_participation\",\n                            \"parameters\": {\n                                \"type\": \"email\",\n                                \"options\": {\n                                    \"notifierAlias\": \"winnielapin\",\n                                    \"to\": \"{{ '{{ flow_data.data.identity.identity_email }}' }}\",\n                                    \"subject\": \"Félicitations! Votre participation a été enregistrée avec succès\",\n                                    \"htmlMessage\": \"{{ '{{ flow_data.retrievedData.identity.retrieved_document|raw }}' }}\"\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"purge_flow_data\",\n                            \"name\": \"purge_identity\",\n                            \"parameters\": {\n                                \"steps\": {\n                                    \"identity\": {\n                                        \"retrieved_data\": [\n                                            \"created_order\",\n                                            \"update_product_order\",\n                                            \"created_participation\",\n                                            \"process_eligibility\",\n                                            \"retrieved_participation\",\n                                            \"retrieved_document\",\n                                            \"reserved_product\",\n                                            \"notify_participation\"\n                                        ]\n                                    }\n                                }\n                            }\n                        },\n                        {\n                            \"action\": \"allow_redo_participation\",\n                            \"parameters\": {\n                                \"participation_id\": \"{{ '{{ flow_data.retrievedData.identity.created_participation.id }}' }}\"\n                            }\n                        }\n                    ]\n                }\n            }\n        },\n        {\n            \"type\": \"end\",\n            \"options\": {\n                \"source\": \"end\",\n                \"next_options\": {\n                    \"label\": \"Terminer\",\n                    \"attr\": {\n                        \"class\": \"button button-black proof-confirm\"\n                    }\n                }\n            }\n        },\n        {\n            \"type\": \"single\",\n            \"options\": {\n                \"source\": \"end\",\n                \"destination\": \"questions\",\n                \"next_options\": {\n                    \"label\": \"Avis\",\n                    \"attr\": {\n                        \"class\": \"next outside\"\n                    }\n                }\n            }\n        },\n        {\n            \"type\": \"end\",\n            \"options\": {\n                \"source\": \"questions\",\n                \"next_options\": {\n                    \"label\": \"valider\",\n                    \"attr\": {\n                        \"class\": \"submit\"\n                    }\n                }\n            }\n        }\n    ]\n}";
